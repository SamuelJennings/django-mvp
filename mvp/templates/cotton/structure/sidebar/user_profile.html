{% load i18n %}
<c-vars logout_url="account_logout"
        login_url=""
        account_center_url
        settings_url />
{# User profile dropup menu in sidebar footer #}
{% if user.is_authenticated %}
  <div class="sidebar-user-profile px-3 py-2 bg-body border-top dropup-center dropup sticky-bottom">
    <div class="btn btn-outline-secondary border-0 d-flex align-items-center gap-2 w-100"
         data-bs-toggle="dropdown"
         aria-expanded="false"
         role="button">
      {# User Avatar Circle #}
      <div class="rounded-circle bg-primary d-inline-flex align-items-center justify-content-center flex-shrink-0"
           style="width: 2.5rem;
                  height: 2.5rem">
        <span class="text-white small fw-medium">{{ user.get_short_name|default:user.username|slice:":1"|upper }}</span>
      </div>
      {# User Info #}
      <div class="text-truncate flex-fill text-start">
        <p class="mb-0 small fw-semibold text-truncate">{{ user.get_full_name|default:user.username }}</p>
        <p class="mb-0 small text-truncate text-muted">{{ user.email }}</p>
      </div>
    </div>
    {# Dropdown Menu #}
    <ul class="dropdown-menu w-100">
      {# Account Center Link #}
      {% if account_center_url %}
        <li>
          <a class="dropdown-item d-flex align-items-center gap-2"
             href="{{ account_center_url }}">
            <c-icon name="person-circle" class="fs-6" />
            <span>{% trans "Account Center" %}</span>
          </a>
        </li>
        <li>
          <hr class="dropdown-divider" />
        </li>
      {% endif %}
      {# Settings Link #}
      {% if settings_url %}
        <li>
          <a class="dropdown-item d-flex align-items-center gap-2"
             href="{{ settings_url }}">
            <c-icon name="gear" class="fs-6" />
            <span>{% trans "Settings" %}</span>
          </a>
        </li>
      {% endif %}
      {# Custom slot for additional menu items #}
      {{ slot }}
      {# Logout #}
      <li>
        <hr class="dropdown-divider" />
      </li>
      <li>
        <button type="submit"
                form="sidebarLogoutForm"
                class="dropdown-item d-flex align-items-center gap-2 text-danger">
          <c-icon name="box-arrow-right" class="fs-6" />
          <span>{% trans "Sign Out" %}</span>
        </button>
      </li>
    </ul>
    {# Logout Form #}
    <form id="sidebarLogoutForm"
          class="d-none"
          action="{% url logout_url %}"
          method="post">
      {% csrf_token %}
    </form>
  </div>
{% else %}
  {# Login link for unauthenticated users - only show if login_url is provided #}
  {% if login_url %}
    <div class="sidebar-user-profile px-3 py-2 bg-body border-top sticky-bottom">
      <a href="{% url login_url %}"
         class="btn btn-primary d-flex align-items-center justify-content-center gap-2 w-100">
        <c-icon name="box-arrow-in-right" class="fs-6" />
        <span>{% trans "Sign In" %}</span>
      </a>
    </div>
  {% endif %}
{% endif %}
