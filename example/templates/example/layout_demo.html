{% extends "base.html" %}
{% block app %}
  {# Build our own app wrapper with explicit control over all layout attributes #}
  <c-app :fixed_sidebar="fixed_sidebar"
         :fixed_header="fixed_header"
         :fixed_footer="fixed_footer"
         sidebar_expand="{{ breakpoint }}">
    <c-app.header />
    <c-app.sidebar />
    <c-app.main>
      <c-app.main.content-header>
        <div class="row">
          <div class="col-sm-6">
            <h3 class="mb-0">Layout Configuration Demo</h3>
          </div>
          <div class="col-sm-6">
            <ol class="breadcrumb float-sm-end">
              <li class="breadcrumb-item">
                <a href="{% url 'dashboard' %}">Home</a>
              </li>
              <li class="breadcrumb-item active"
                  aria-current="page">Layout Demo</li>
            </ol>
          </div>
        </div>
      </c-app.main.content-header>
      <c-app.main.content>
        <div class="container-fluid">
          <div class="row">
            {# Main Content Column - Left Side (8 columns on lg+) #}
            <div class="col-lg-8">
              <c-card title="Interactive Layout Configuration Demo">
                <div class="alert alert-info">
                  <h5 class="alert-heading">
                    <i class="fas fa-info-circle me-2"></i>
                    About This Demo
                  </h5>
                  <p>
                    This page demonstrates all AdminLTE layout configuration options
                    in a single interactive view. Use the configuration form on the right
                    to toggle different layout behaviors.
                  </p>
                </div>
                <h4>Current Configuration</h4>
                <table class="table table-bordered">
                  <thead>
                    <tr>
                      <th>Property</th>
                      <th>Value</th>
                      <th>Description</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>
                        <code>fixed_sidebar</code>
                      </td>
                      <td>
                        {% if fixed_sidebar %}
                          <span class="badge bg-success">Enabled</span>
                        {% else %}
                          <span class="badge bg-secondary">Disabled</span>
                        {% endif %}
                      </td>
                      <td>Sidebar stays fixed when scrolling content</td>
                    </tr>
                    <tr>
                      <td>
                        <code>fixed_header</code>
                      </td>
                      <td>
                        {% if fixed_header %}
                          <span class="badge bg-success">Enabled</span>
                        {% else %}
                          <span class="badge bg-secondary">Disabled</span>
                        {% endif %}
                      </td>
                      <td>Header navbar stays fixed at top of viewport</td>
                    </tr>
                    <tr>
                      <td>
                        <code>fixed_footer</code>
                      </td>
                      <td>
                        {% if fixed_footer %}
                          <span class="badge bg-success">Enabled</span>
                        {% else %}
                          <span class="badge bg-secondary">Disabled</span>
                        {% endif %}
                      </td>
                      <td>Footer stays fixed at bottom of viewport</td>
                    </tr>
                    <tr>
                      <td>
                        <code>breakpoint</code>
                      </td>
                      <td>
                        <span class="badge bg-primary">{{ breakpoint }}</span>
                      </td>
                      <td>Breakpoint at which sidebar auto-expands</td>
                    </tr>
                  </tbody>
                </table>
                <div class="alert alert-success">
                  <h5 class="alert-heading">
                    <i class="fas fa-bookmark me-2"></i>
                    Shareable URL
                  </h5>
                  <p>
                    This page uses query parameters to maintain state, making
                    configurations <strong>shareable via URL</strong>. The current
                    configuration can be bookmarked or shared with others.
                  </p>
                  <p class="mb-0">
                    <strong>Current URL:</strong>
                    <br />
                    <code>{{ request.get_full_path }}</code>
                  </p>
                </div>
                <h4>CSS Classes Applied</h4>
                <p>Based on your current configuration, these CSS classes are applied:</p>
                <ul>
                  {% if fixed_sidebar %}
                    <li>
                      <code>.layout-fixed</code> - Fixed sidebar positioning
                    </li>
                  {% endif %}
                  {% if fixed_header %}
                    <li>
                      <code>.fixed-header</code> - Fixed header navbar
                    </li>
                  {% endif %}
                  {% if fixed_footer %}
                    <li>
                      <code>.fixed-footer</code> - Fixed footer positioning
                    </li>
                  {% endif %}
                  <li>
                    <code>.sidebar-expand-{{ breakpoint }}</code> - Sidebar expansion breakpoint
                  </li>
                </ul>
                <div class="alert alert-warning">
                  <h5 class="alert-heading">
                    <i class="fas fa-code me-2"></i>
                    For Developers
                  </h5>
                  <p>
                    This demo page is <strong>extensible</strong> for future feature specs.
                    Other specifications can add new layout options by:
                  </p>
                  <ol>
                    <li>Adding query parameters to the form</li>
                    <li>Updating the view to parse new parameters</li>
                    <li>Passing new context variables to the template</li>
                    <li>Demonstrating new behaviors in this same unified interface</li>
                  </ol>
                  <p class="mb-0">
                    See <code>docs/components/app.md</code> for full component documentation.
                  </p>
                </div>
              </c-card>
            </div>
            {# Configuration Form Column - Right Sidebar (4 columns on lg+) #}
            <div class="col-lg-4">
              <c-card title="Configuration">
                <form id="configSelect"
                      method="get"
                      action="{% url 'layout_demo' %}">
                  <div class="mb-3">
                    <h5>Fixed Layout Properties</h5>
                    <p class="text-muted small">Check boxes to enable fixed positioning for layout elements.</p>
                    <div class="form-check mb-2">
                      <input class="form-check-input"
                             type="checkbox"
                             name="fixed_sidebar"
                             id="fixed_sidebar"
                             {% if fixed_sidebar %}checked{% endif %} />
                      <label class="form-check-label" for="fixed_sidebar">
                        <strong>Fixed Sidebar</strong>
                        <br />
                        <small class="text-muted">Sidebar remains visible when scrolling content</small>
                      </label>
                    </div>
                    <div class="form-check mb-2">
                      <input class="form-check-input"
                             type="checkbox"
                             name="fixed_header"
                             id="fixed_header"
                             {% if fixed_header %}checked{% endif %} />
                      <label class="form-check-label" for="fixed_header">
                        <strong>Fixed Header</strong>
                        <br />
                        <small class="text-muted">Navbar stays fixed at top of viewport</small>
                      </label>
                    </div>
                    <div class="form-check mb-3">
                      <input class="form-check-input"
                             type="checkbox"
                             name="fixed_footer"
                             id="fixed_footer"
                             {% if fixed_footer %}checked{% endif %} />
                      <label class="form-check-label" for="fixed_footer">
                        <strong>Fixed Footer</strong>
                        <br />
                        <small class="text-muted">Footer stays fixed at bottom of viewport</small>
                      </label>
                    </div>
                  </div>
                  <div class="mb-3">
                    <h5>Responsive Breakpoint</h5>
                    <p class="text-muted small">Select the breakpoint at which the sidebar auto-expands.</p>
                    <label for="breakpoint" class="form-label">Sidebar Expansion Breakpoint</label>
                    <select class="form-select"
                            name="breakpoint"
                            id="breakpoint">
                      {% for bp in breakpoints %}
                        <option value="{{ bp }}"
                                {% if bp == breakpoint %}selected{% endif %}>
                          {{ bp|upper }} -
                          {% if bp == "sm" %}
                            ≥576px
                          {% elif bp == "md" %}
                            ≥768px
                          {% elif bp == "lg" %}
                            ≥992px
                          {% elif bp == "xl" %}
                            ≥1200px
                          {% elif bp == "xxl" %}
                            ≥1400px
                          {% endif %}
                        </option>
                      {% endfor %}
                    </select>
                    <div class="form-text">The sidebar will auto-expand at this screen width and above.</div>
                  </div>
                  <div class="d-grid gap-2">
                    <a href="{% url 'layout_demo' %}"
                       class="btn btn-secondary">
                      <i class="fas fa-undo me-2"></i>
                      Reset to Defaults
                    </a>
                  </div>
                </form>
                <hr />
                <div class="alert alert-light mb-0">
                  <h6>
                    <i class="fas fa-lightbulb me-2"></i>Tips
                  </h6>
                  <ul class="mb-0 small">
                    <li>Changes apply instantly - no need to click submit</li>
                    <li>Try different combinations to see how they interact</li>
                    <li>Resize your browser window to test responsive behavior</li>
                    <li>Bookmark configurations you like for quick access</li>
                    <li>Share URLs with team members to demonstrate layouts</li>
                  </ul>
                </div>
              </c-card>
            </div>
          </div>
        </div>
      </c-app.main.content>
    </c-app.main>
    <c-app.footer />
  </c-app>
{% endblock app %}
{% block extra_js %}
  {# djlint:off #}
  <script>
    // Auto-submit form when configuration inputs change
    document.addEventListener('DOMContentLoaded', function() {
      const form = document.getElementById('configSelect');
      if (form) {
        // Get all checkboxes and selects in the form
        const inputs = form.querySelectorAll('input[type="checkbox"], select');

        inputs.forEach(function(input) {
          input.addEventListener('change', function() {
            // Submit the form automatically when any input changes
            form.submit();
          });
        });
      }
    });
</script>
  {# djlint:on #}
{% endblock extra_js %}
